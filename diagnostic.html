<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ¨ç½²è¯Šæ–­å·¥å…·</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; }
        .test-section { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        #results { margin-top: 20px; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Verceléƒ¨ç½²è¯Šæ–­å·¥å…·</h1>

    <div class="test-section info">
        <h3>ğŸ“‹ è¯Šæ–­æ­¥éª¤</h3>
        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®ä¾æ¬¡æµ‹è¯•å„ä¸ªç»„ä»¶ï¼š</p>
        <button onclick="testAPI()">1. æµ‹è¯•APIç«¯ç‚¹</button>
        <button onclick="testReact()">2. æµ‹è¯•Reactåº”ç”¨</button>
        <button onclick="testFullFunction()">3. æµ‹è¯•å®Œæ•´åŠŸèƒ½</button>
    </div>

    <div id="results"></div>

    <script>
        const log = (message, type = 'info') => {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-section ${type}`;
            div.innerHTML = `<p><strong>${new Date().toLocaleTimeString()}</strong>: ${message}</p>`;
            results.appendChild(div);
        };

        const testAPI = async () => {
            log('ğŸ” æµ‹è¯•APIç«¯ç‚¹...', 'info');

            try {
                // æµ‹è¯•åŸºç¡€API
                const response = await fetch('/api/edgar');
                const data = await response.json();

                if (response.ok) {
                    log(`âœ… APIç«¯ç‚¹æ­£å¸¸å“åº”: ${data.message}`, 'success');
                    console.log('APIå“åº”:', data);
                } else {
                    log(`âŒ APIå“åº”é”™è¯¯: ${data.error || response.statusText}`, 'error');
                }
            } catch (error) {
                log(`âŒ APIè¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
                console.error('APIé”™è¯¯:', error);
            }
        };

        const testReact = () => {
            log('âš›ï¸ æµ‹è¯•Reactåº”ç”¨...', 'info');

            try {
                // æ£€æŸ¥Reactæ˜¯å¦æ­£å¸¸åŠ è½½
                const rootElement = document.getElementById('root');
                if (rootElement) {
                    log('âŒ è­¦å‘Š: å‘ç°äº†Reactæ ¹å…ƒç´ ï¼Œè¯´æ˜è¿™ä¸æ˜¯Reactåº”ç”¨é¡µé¢', 'error');
                } else {
                    log('âœ… å½“å‰æ˜¯è¯Šæ–­é¡µé¢ï¼ŒReactåº”ç”¨åº”è¯¥åœ¨ä¸»é¡µ', 'success');
                }

                // æ£€æŸ¥æ˜¯å¦æœ‰Reactç›¸å…³é”™è¯¯
                if (window.React) {
                    log('âœ… Reactåº“å·²åŠ è½½', 'success');
                } else {
                    log('â„¹ï¸ Reactåº“æœªåœ¨æ­¤é¡µé¢åŠ è½½ï¼ˆæ­£å¸¸ï¼Œè¿™æ˜¯è¯Šæ–­é¡µé¢ï¼‰', 'info');
                }
            } catch (error) {
                log(`âŒ Reactæ£€æŸ¥å¤±è´¥: ${error.message}`, 'error');
            }
        };

        const testFullFunction = async () => {
            log('ğŸ§ª æµ‹è¯•å®Œæ•´åŠŸèƒ½...', 'info');

            try {
                // æµ‹è¯•å…¬å¸æœç´¢API
                const searchResponse = await fetch('/api/companies/search?q=AAPL');
                const searchData = await searchResponse.json();

                if (searchResponse.ok && searchData.success) {
                    log(`âœ… å…¬å¸æœç´¢åŠŸèƒ½æ­£å¸¸: æ‰¾åˆ° ${searchData.data.length} ä¸ªç»“æœ`, 'success');
                    log(`ğŸ“Š æœç´¢ç»“æœ: ${JSON.stringify(searchData.data[0], null, 2)}`, 'info');
                } else {
                    log(`âŒ å…¬å¸æœç´¢å¤±è´¥: ${searchData.error || 'æœªçŸ¥é”™è¯¯'}`, 'error');
                }
            } catch (error) {
                log(`âŒ åŠŸèƒ½æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥åŸºç¡€çŠ¶æ€
        window.onload = () => {
            log('ğŸš€ éƒ¨ç½²è¯Šæ–­å·¥å…·å·²åŠ è½½', 'success');
            log('ğŸ“ å½“å‰åŸŸå: ' + window.location.hostname, 'info');
            log('ğŸ”— å½“å‰URL: ' + window.location.href, 'info');
        };
    </script>
</body>
</html>